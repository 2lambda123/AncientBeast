/*! AncienBeast 17-01-2015 */
var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Game=function(a){function b(){a.call(this,1920,1080,Phaser.AUTO,null),this.state.add("preloadState",preload.State,!1),this.state.add("loadState",load.State,!1),this.state.add("battleState",battle.State,!1),this.state.start("preloadState",!1,!1,"battleState")}return __extends(b,a),b}(Phaser.Game);window.onload=function(){new Game};var battle;!function(a){var b=function(b){function c(){b.apply(this,arguments)}return __extends(c,b),c.prototype.create=function(){new a.Background(this,0,0,"background"),new a.Unit(this,0,0,"unit");for(var b=0;11>b;b++)if(b%2)for(var c=0;15>c;c++)new a.Tile(this,285+90*c,380+62*b,"hex");else for(var c=0;16>c;c++)new a.Tile(this,240+90*c,380+62*b,"hex")},c}(Phaser.State);a.State=b}(battle||(battle={}));var battle;!function(a){var b=function(a){function b(b,c,d,e){a.call(this,b.game,c,d,e),this.state=b,b.game.add.existing(this)}return __extends(b,a),b}(Phaser.Sprite);a.Background=b}(battle||(battle={}));var battle;!function(a){var b=function(a){function b(b,c,d,e){a.call(this,b.game,c,d,e),this.state=b,b.game.add.existing(this)}return __extends(b,a),b}(Phaser.Sprite);a.Hero=b}(battle||(battle={}));var battle;!function(a){var b=function(a){function b(b,c,d,e){a.call(this,b.game,c,d,e),this.state=b,this.anchor.setTo(.5),this.scale.y=.8,b.game.add.existing(this)}return __extends(b,a),b}(Phaser.Sprite);a.Tile=b}(battle||(battle={}));var battle;!function(a){var b=function(a){function b(b,c,d,e){a.call(this,b.game,c,d,e),this.state=b,b.game.add.existing(this)}return __extends(b,a),b}(Phaser.Sprite);a.Unit=b}(battle||(battle={}));var game;!function(a){var b=function(b){function c(){b.apply(this,arguments),this.enemyCountLeft=0}return __extends(c,b),c.prototype.create=function(){this.map=[[2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0],[2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0],[2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,2,2,0,2,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0],[2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,2,2,2,2,2,2,0,0,0,0,0,0,0],[2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,2,2,0,2,2,2,0,0,0,0,0,0,0],[2,2,2,2,2,2,2,0,0,0,0,0,2,2,0,0,0,0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0],[2,2,2,2,2,2,2,0,0,0,0,0,2,2,2,0,0,0,0,0,0,2,2,2,2,2,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,2,2,0,0],[2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,2,2,2,2,0],[0,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,0],[0,0,2,2,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2],[0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,2,2,2,2],[0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,2,2,0,0,0,0,0,2,0,0,0,0,2,2,2,0,0,0,0,0,0,0],[0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0],[0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0],[0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0],[0,0,0,0,0,0,2,2,2,0,0,0,2,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0],[0,0,0,0,0,0,2,2,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,2,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0],[0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,0,0,0,0,0,0,0,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2],[2,2,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2],[2,2,2,0,2,2,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,2,2,2,0,0,0,0,0,0,0,2,2,2,0,0],[2,2,2,2,2,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,2,2,0,0,2,2,2,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,2,0,0],[0,0,2,2,2,0,0,0,2,2,2,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0],[0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,2,2,2,2,2,2,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,2,2,2,2,2,2,0,0,0,0,0,0,2,0,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],this.startingPositions=[{x:14,y:0},{x:35,y:0},{x:47,y:0},{x:47,y:15},{x:47,y:33},{x:29,y:33},{x:12,y:33}],this.spawnPosition=[{x:14,y:-1},{x:35,y:-1},{x:48,y:-1},{x:48,y:15},{x:48,y:34},{x:29,y:34},{x:12,y:34}],this.waves=[{start:this.startingPositions[6],spawn:this.spawnPosition[6],enemyCount:20,health:100,timer:2,speed:1200},{start:this.startingPositions[1],spawn:this.spawnPosition[1],enemyCount:30,health:120,timer:1.5,speed:1e3},{start:this.startingPositions[3],spawn:this.spawnPosition[3],enemyCount:50,health:150,timer:1.2,speed:900},{start:this.startingPositions[5],spawn:this.spawnPosition[5],enemyCount:70,health:200,timer:1,speed:800},{start:this.startingPositions[2],spawn:this.spawnPosition[2],enemyCount:80,health:300,timer:.9,speed:700},{start:this.startingPositions[4],spawn:this.spawnPosition[4],enemyCount:100,health:420,timer:.8,speed:600},{start:this.startingPositions[1],spawn:this.spawnPosition[1],enemyCount:110,health:500,timer:.7,speed:550},{start:this.startingPositions[4],spawn:this.spawnPosition[4],enemyCount:130,health:600,timer:.5,speed:500},{start:this.startingPositions[6],spawn:this.spawnPosition[6],enemyCount:150,health:750,timer:.4,speed:450}],this.nextWaveNumber=0,this.enemies=[],this.energy=700,this.events={destroyPath:new Phaser.Signal},this.music=this.add.audio("main"),this.music.loop=!0,this.music.play(),new a.MusicSwitch(this,{x:300,y:this.world.height-50,name:"soundOn"}),this.dunk=this.add.audio("dunk"),this.dunk.volume=.2,this.hit=this.add.audio("hit"),this.hit.volume=.5,this.nope=this.add.audio("nope"),this.nope.volume=.2,this.game.stage.backgroundColor="e2a179",this.game.add.sprite(0,0,"base"),this.game.add.sprite(250,720,"dragtobuild"),new a.BaseTurret(this,{x:290,y:460,name:"wall",price:0,group:this.buildingSort}),new a.BaseTurret(this,{x:290,y:550,name:"wall",price:0,group:this.buildingSort}),new a.Start(this,{x:5,y:380,name:"start"}),new a.Button(this,{x:5,y:830,name:"wall"}),new a.Button(this,{x:205,y:830,name:"turret"}),new a.Button(this,{x:5,y:890,name:"freezer"}),new a.Button(this,{x:205,y:890,name:"howitzer"}),new a.Button(this,{x:5,y:950,name:"tesla"}),new a.Button(this,{x:205,y:950,name:"nuker"}),this.sortGroup=this.game.add.group(),this.buildingSort=this.game.add.group(),this.sortGroup.add(new a.Wall(this,{x:15,y:826,name:"wall",price:30,group:this.sortGroup})),this.buildingSort.add(new a.Turret(this,{x:215,y:810,name:"turret",price:100,group:this.buildingSort})),this.buildingSort.add(new a.Freezer(this,{x:15,y:870,name:"freezer",price:400,group:this.buildingSort})),this.buildingSort.add(new a.Howitzer(this,{x:215,y:870,name:"howitzer",price:500,group:this.buildingSort})),this.buildingSort.add(new a.Tesla(this,{x:15,y:930,name:"tesla",price:800,group:this.buildingSort})),this.buildingSort.add(new a.Nuker(this,{x:215,y:930,name:"nuker",price:1500,group:this.buildingSort})),this.energyText=this.add.text(10,this.world.height-35,"Your energy: "+this.energy,{});for(var b=0;34>b;b++)this.sortGroup.add(new a.HillsLayer(this,{x:400,y:32*b,atlas:"hills",name:"hills_"+b+".png"}));var c=this.waves[this.nextWaveNumber],d=new PF.Grid(48,34,this.map),e=new PF.AStarFinder({allowDiagonal:!0,dontCrossCorners:!0}),f=e.findPath(c.start.x,c.start.y,0,18,d);this.markPath(f)},c.prototype.update=function(){this.sortGroup.sort("y",Phaser.Group.SORT_ASCENDING),this.buildingSort.sort("y",Phaser.Group.SORT_ASCENDING)},c.prototype.startWave=function(b){var c=this;if(this.enemyCountLeft>0)return void(this.music.isPlaying&&this.nope.play());this.events.destroyPath.dispatch(),this.enemyCountLeft=this.waves[this.nextWaveNumber].enemyCount;var d,e=this.waves[b],f=new PF.Grid(48,34,this.map),g=new PF.AStarFinder({allowDiagonal:!0,dontCrossCorners:!0});d=g.findPath(e.start.x,e.start.y,0,18,f);var h=[];this.game.time.events.repeat(Phaser.Timer.SECOND*e.timer,e.enemyCount,function(){h=d.slice(0);var b=new a.Enemy(c,{xId:e.spawn.x,yId:e.spawn.y,name:"enemy",path:h,health:e.health,speed:e.speed});c.enemies.push(b),c.sortGroup.add(b)},this)},c.prototype.markPath=function(b){var c=this;b.forEach(function(b){c.sortGroup.add(new a.Marker(c,{xId:b[0],yId:b[1],name:"marker"}))})},c.prototype.changeEnergy=function(a){this.energy+=a,this.energyText.setText("Your energy: "+this.energy)},c.prototype.recalculate=function(a,b,c){this.events.destroyPath.dispatch();var d=this.waves[this.nextWaveNumber],e=new PF.Grid(48,34,this.map),f=new PF.AStarFinder({allowDiagonal:!0,dontCrossCorners:!0}),g=[];return g=f.findPath(d.start.x,d.start.y,0,18,e),!g.length||this.enemyCountLeft>0?(this.map[c][b]=0,void a.blocksPath()):void this.markPath(g)},c.prototype.waveCounter=function(){if(this.enemyCountLeft--,0==this.enemyCountLeft){if(this.nextWaveNumber++,9==this.nextWaveNumber)return void this.game.state.start("textState",!0,!0,"You won! Due to time limit, take this text line as a big flashy victory screen");var a=this.waves[this.nextWaveNumber],b=new PF.Grid(48,34,this.map),c=new PF.AStarFinder({allowDiagonal:!0,dontCrossCorners:!0}),d=c.findPath(a.start.x,a.start.y,0,18,b);this.markPath(d)}},c}(Phaser.State);a.State=b}(game||(game={}));var game;!function(a){var b=function(a){function b(b,c){a.call(this,b.game,c.x,c.y,c.name),this.state=b,b.game.add.existing(this)}return __extends(b,a),b}(Phaser.Sprite);a.Background=b}(game||(game={}));var game;!function(a){var b=function(a){function b(b,c){a.call(this,b.game,c.x,c.y,c.name),this.state=b,this.data=c,b.game.add.existing(this),this.inputEnabled=!0,this.input.enableDrag(!0,!0),this.events.onDragStart.add(this.dragStarted,this),this.events.onDragStop.add(this.dragStopped,this),this.input.enableSnap(32,32,!0,!0,400)}return __extends(b,a),b.prototype.update=function(){this.followCircle&&(this.circle.x=this.x+16,this.circle.y=this.y+32)},b.prototype.dragStarted=function(){return this.state.energy<this.data.price?(this.state.music.isPlaying&&this.state.nope.play(),this.rebuild(),void this.destroy()):(this.circle=this.state.game.add.graphics(this.x+16,this.y+32),this.circle.lineStyle(1,16711680),this.circle.drawCircle(0,0,2*this.range),this.followCircle=!0,void this.state.changeEnergy(-this.data.price))},b.prototype.dragStopped=function(){this.circle.destroy(),this.rebuild();var a=Math.round((this.x-400)/32),b=Math.round(this.y/32);this.inputEnabled=!1,this.repurpose(a,b)},b.prototype.repurpose=function(a,b){return b++,"undefined"==typeof this.state.map[b][a]||2!==this.state.map[b][a]?(this.state.changeEnergy(this.data.price),this.state.music.isPlaying&&this.state.nope.play(),void this.destroy()):(this.state.music.isPlaying&&this.state.dunk.play(),void(this.state.map[b][a]=5))},b.prototype.rebuild=function(){this.data.group.add(new b(this.state,this.data))},b}(Phaser.Sprite);a.Building=b}(game||(game={}));var game;!function(a){var b=function(b){function c(a,c){var d=this;b.call(this,a,c),this.state=a,this.data=c,this.fireRate=.5,this.range=300,this.dmg=50,a.game.add.existing(this),this.rangeSq=this.range*this.range,this.alpha=0,this.inputEnabled=!1,this.game.time.events.loop(Phaser.Timer.SECOND*this.fireRate,function(){if(0==d.inputEnabled)for(var a=0;a<d.state.enemies.length;a++){var b=d.state.enemies[a];if(b.game){var c=b.x-d.x+16,e=b.y-d.y+32,f=c*c+e*e;if(f<d.rangeSq){d.state.music.isPlaying&&d.state.hit.play(),b.dmg(d.dmg);break}}}},this)}return __extends(c,b),c.prototype.rebuild=function(){this.data.group.add(new a.Turret(this.state,this.data))},c}(a.Building);a.BaseTurret=b}(game||(game={}));var game;!function(a){var b=function(a){function b(b,c){var d=this;a.call(this,b,c),this.state=b,this.data=c,this.fireRate=.5,this.range=100,this.dmg=5,b.game.add.existing(this),this.rangeSq=this.range*this.range,this.game.time.events.loop(Phaser.Timer.SECOND*this.fireRate,function(){if(0==d.inputEnabled)for(var a=0;a<d.state.enemies.length;a++){var b=d.state.enemies[a];if(b.game){var c=b.x-d.x+16,e=b.y-d.y+32,f=c*c+e*e;if(f<d.rangeSq){b.dmg(d.dmg),b.slow();break}}}},this)}return __extends(b,a),b.prototype.rebuild=function(){this.data.group.add(new b(this.state,this.data))},b}(a.Building);a.Freezer=b}(game||(game={}));var game;!function(a){var b=function(a){function b(b,c){var d=this;a.call(this,b,c),this.state=b,this.data=c,this.fireRate=2,this.range=250,this.dmg=60,b.game.add.existing(this),this.rangeSq=this.range*this.range,this.game.time.events.loop(Phaser.Timer.SECOND*this.fireRate,function(){if(0==d.inputEnabled)for(var a=0;a<d.state.enemies.length;a++){var b=d.state.enemies[a];if(b.game){var c=b.x-d.x+16,e=b.y-d.y+32,f=c*c+e*e;if(f<d.rangeSq){d.state.music.isPlaying&&d.state.hit.play(),b.dmg(d.dmg);break}}}},this)}return __extends(b,a),b.prototype.rebuild=function(){this.data.group.add(new b(this.state,this.data))},b}(a.Building);a.Howitzer=b}(game||(game={}));var game;!function(a){var b=function(a){function b(b,c){var d=this;a.call(this,b,c),this.state=b,this.data=c,this.fireRate=3,this.range=500,this.dmg=400,b.game.add.existing(this),this.rangeSq=this.range*this.range,this.game.time.events.loop(Phaser.Timer.SECOND*this.fireRate,function(){if(0==d.inputEnabled)for(var a=0;a<d.state.enemies.length;a++){var b=d.state.enemies[a];if(b.game){var c=b.x-d.x+16,e=b.y-d.y+32,f=c*c+e*e;if(f<d.rangeSq){d.state.music.isPlaying&&d.state.hit.play(),b.dmg(d.dmg);break}}}},this)}return __extends(b,a),b.prototype.rebuild=function(){this.data.group.add(new b(this.state,this.data))},b}(a.Building);a.Nuker=b}(game||(game={}));var game;!function(a){var b=function(a){function b(b,c){var d=this;a.call(this,b,c),this.state=b,this.data=c,this.fireRate=.2,this.range=100,this.dmg=20,b.game.add.existing(this),this.rangeSq=this.range*this.range,this.game.time.events.loop(Phaser.Timer.SECOND*this.fireRate,function(){if(0==d.inputEnabled)for(var a=0;a<d.state.enemies.length;a++){var b=d.state.enemies[a];if(b.game){var c=b.x-d.x+16,e=b.y-d.y+32,f=c*c+e*e;if(f<d.rangeSq){b.dmg(d.dmg);break}}}},this)}return __extends(b,a),b.prototype.rebuild=function(){this.data.group.add(new b(this.state,this.data))},b}(a.Building);a.Tesla=b}(game||(game={}));var game;!function(a){var b=function(a){function b(b,c){var d=this;a.call(this,b,c),this.state=b,this.data=c,this.fireRate=1,this.range=150,this.dmg=25,b.game.add.existing(this),this.rangeSq=this.range*this.range,this.game.time.events.loop(Phaser.Timer.SECOND*this.fireRate,function(){if(0==d.inputEnabled)for(var a=0;a<d.state.enemies.length;a++){var b=d.state.enemies[a];if(b.game){var c=b.x-d.x+16,e=b.y-d.y+32,f=c*c+e*e;if(f<d.rangeSq){d.state.music.isPlaying&&d.state.hit.play(),b.dmg(d.dmg);break}}}},this)}return __extends(b,a),b.prototype.rebuild=function(){this.data.group.add(new b(this.state,this.data))},b}(a.Building);a.Turret=b}(game||(game={}));var game;!function(a){var b=function(a){function b(b,c){a.call(this,b,c),this.state=b,this.data=c,b.game.add.existing(this)}return __extends(b,a),b.prototype.repurpose=function(a,b){return"undefined"==typeof this.state.map[b][a]||2==this.state.map[b][a]||4==this.state.map[b][a]?(this.state.changeEnergy(this.data.price),this.state.music.isPlaying&&this.state.nope.play(),void this.destroy()):(this.state.map[b][a]=4,this.state.music.isPlaying&&this.state.dunk.play(),this.y+=16,void this.state.recalculate(this,a,b,2))},b.prototype.rebuild=function(){this.data.group.add(new b(this.state,this.data))},b.prototype.blocksPath=function(){this.state.changeEnergy(this.data.price),this.destroy(),this.state.music.isPlaying&&this.state.nope.play(),this.state.recalculate(0,0,0,0)},b}(a.Building);a.Wall=b}(game||(game={}));var game;!function(a){var b=function(a){function b(b,c){a.call(this,b.game,c.x,c.y,c.name+"Button"),this.state=b,b.game.add.existing(this)}return __extends(b,a),b}(Phaser.Sprite);a.Button=b}(game||(game={}));var game;!function(a){var b=function(b){function c(a,c){b.call(this,a.game,32*c.xId+400,32*c.yId,c.name),this.state=a,this.data=c,this.bounty=30,a.game.add.existing(this),this.health=c.health,this.speed=c.speed,this.animations.add("walk",[0,1,2,1,0]),this.animations.play("walk",8,!0),this.tint=16777215*Math.random(),this.tweenAlongPath()}return __extends(c,b),c.prototype.tweenAlongPath=function(){if(!this.data.path.length)return void this.finished();var a=this.data.path.shift(),b=32*a[0]+400,c=32*a[1],d=this.state.game.add.tween(this);d.to({y:c+10,x:b},this.speed,Phaser.Easing.Linear.None,!0,0,0),d.onComplete.add(this.tweenAlongPath,this)},c.prototype.finished=function(){this.health>0&&this.game.state.start("textState",!0,!0,"Your base was destroyed!")},c.prototype.dmg=function(b){this.health-=b,new a.Explosion(this.state,{x:this.x,y:this.y,name:"boom"}),this.health<=0&&(this.state.changeEnergy(this.bounty),this.state.waveCounter(),this.destroy())},c.prototype.slow=function(){var a=this;this.speed=2*this.speed,this.state.game.time.events.add(3*Phaser.Timer.SECOND,function(){a.speed=2*a.data.speed},this)},c}(Phaser.Sprite);a.Enemy=b}(game||(game={}));var game;!function(a){var b=function(a){function b(b,c){a.call(this,b.game,c.x,c.y,c.name),this.state=b,b.game.add.existing(this),this.alpha=0,this.tweens=this.state.game.add.tween(this),this.tweenIn()}return __extends(b,a),b.prototype.tweenIn=function(){this.tweens.to({alpha:1},200,Phaser.Easing.Quadratic.InOut).to({alpha:0},500,Phaser.Easing.Quadratic.InOut),this.tweens.onComplete.add(this.tweenEnded,this),this.tweens.start()},b.prototype.tweenEnded=function(){this.destroy()},b}(Phaser.Sprite);a.Explosion=b}(game||(game={}));var game;!function(a){var b=function(a){function b(b,c){a.call(this,b.game,c.x,c.y-.01,c.atlas,c.name),this.state=b,b.game.add.existing(this)}return __extends(b,a),b}(Phaser.Sprite);a.HillsLayer=b}(game||(game={}));var game;!function(a){var b=function(a){function b(b,c){a.call(this,b.game,32*c.xId+400,32*c.yId+16,c.name),this.state=b,b.game.add.existing(this),this.animations.add("glow",[0,1,2,3,4,5,6,5,4,3,2,1,0]),this.animations.play("glow",15,!0),b.events.destroyPath.add(this.destroy,this)}return __extends(b,a),b}(Phaser.Sprite);a.Marker=b}(game||(game={}));var game;!function(a){var b=function(a){function b(b,c){a.call(this,b.game,c.x,c.y,c.name),this.state=b,b.game.add.existing(this),this.inputEnabled=!0,this.scale.setTo(.5),this.events.onInputUp.add(this.clicked,this)}return __extends(b,a),b.prototype.clicked=function(){this.state.music.isPlaying?(this.state.music.pause(),this.loadTexture("soundOff",{})):(this.state.music.resume(),this.loadTexture("soundOn",{}))},b}(Phaser.Sprite);a.MusicSwitch=b}(game||(game={}));var game;!function(a){var b=function(a){function b(b,c){a.call(this,b.game,c.x,c.y,c.name),this.state=b,b.game.add.existing(this),this.inputEnabled=!0,this.events.onInputUp.add(this.clicked,this)}return __extends(b,a),b.prototype.clicked=function(){this.state.startWave(this.state.nextWaveNumber)},b}(Phaser.Sprite);a.Start=b}(game||(game={}));var load;!function(a){var b=function(b){function c(){b.apply(this,arguments)}return __extends(c,b),c.prototype.init=function(a){this.nextState=a},c.prototype.preload=function(){new a.Logo(this,{x:this.game.width/2,y:this.game.height/2,name:"ugnis"}),this.load.image("background","images/bg2.jpg"),this.load.image("hex","images/hex.png"),this.load.image("unit","images/CyberHound.png")},c.prototype.create=function(){this.game.state.start(this.nextState)},c}(Phaser.State);a.State=b}(load||(load={}));var preload;!function(a){var b=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.init=function(a){this.nextState=a,this.game.scale.scaleMode=Phaser.ScaleManager.EXACT_FIT},b.prototype.preload=function(){this.load.image("ugnis","images/ugnis.jpg")},b.prototype.create=function(){this.game.state.start("loadState",!1,!1,this.nextState)},b}(Phaser.State);a.State=b}(preload||(preload={}));var load;!function(a){var b=function(a){function b(b,c){a.call(this,b.game,c.x,c.y,c.name),this.state=b,this.anchor.setTo(.5),this.alpha=0,b.game.add.existing(this),this.tween=b.game.add.tween(this),this.tweenIn(),this.text=b.game.add.text(this.x,this.y+this.height/2+20,"LOADING: 0%",{}),this.text.anchor.set(.5,.5),this.text.align="center",this.text.font="Arial Black",this.text.fontSize=50,this.text.fontWeight="bold",this.text.stroke="#000000",this.text.strokeThickness=6,this.text.fill="#ffffff",b.game.load.onFileComplete.add(this.fileComplete,this)}return __extends(b,a),b.prototype.tweenIn=function(){this.tween.to({alpha:1},1500,Phaser.Easing.Quadratic.InOut,!0,0,-1,!0)},b.prototype.fileComplete=function(a){this.text.setText("LOADING: "+a+"%")},b}(Phaser.Sprite);a.Logo=b}(load||(load={}));