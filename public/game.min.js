/*! AncienBeast 04-02-2015 */
var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},Game=function(a){function b(){a.call(this,1920,1080,Phaser.AUTO,null),this.state.add("preloadState",preload.State,!1),this.state.add("loadState",load.State,!1),this.state.add("battleState",battle.State,!1),this.state.start("preloadState",!1,!1,"battleState")}return __extends(b,a),b}(Phaser.Game),battle;!function(a){var b=function(b){function c(){b.apply(this,arguments)}return __extends(c,b),c.prototype.create=function(){var b=this;this.battleGround=[[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],this.tiles=[],new a.Background(this,0,0,"background"),this.battleGround.forEach(function(c,d){var e=[];if(d%2)for(var f=0;15>f;f++)e.push(new a.Tile(b,285+90*f,380+62*d,"hex"));else for(var f=0;16>f;f++)e.push(new a.Tile(b,240+90*f,380+62*d,"hex"));b.tiles.push(e)});var c=new a.Wolf(this,0,0,"unit"),d=c.pathFinder.getWalkableTiles();d.forEach(function(a){b.tiles[a.y][a.x].changeColor()})},c}(Phaser.State);a.State=b}(battle||(battle={}));var battle;!function(a){var b=function(){function a(a){this.unit=a,this.grid=a.state.battleGround,this.generatePaths()}return a.prototype.generatePaths=function(){var a=this;this.pathContainer=[];for(var b=0;b<this.grid.length;b++)this.pathContainer.push(this.grid[b].slice());this.fringes=[],this.fringes.push({xId:this.unit.xId,yId:this.unit.yId,path:[]}),this.newFringes=[],this.walkableTiles=[];for(var c=0;c<this.unit.speed;c++)this.fringes.forEach(function(b){a.checkAroundTile(b)}),this.fringes=this.newFringes,this.newFringes=[]},a.prototype.checkAroundTile=function(a){var b,c=this,d=a.xId,e=a.yId;b=e%2?[{x:d,y:e-1},{x:d+1,y:e-1},{x:d-1,y:e},{x:d+1,y:e},{x:d,y:e+1},{x:d+1,y:e+1}]:[{x:d-1,y:e-1},{x:d,y:e-1},{x:d-1,y:e},{x:d+1,y:e},{x:d-1,y:e+1},{x:d,y:e+1}],b.forEach(function(b){for(var d=0;d<c.unit.size;d++)if(!c.canAddPath(b.x+d,b.y))return;var e=a.path.slice();e.push(b);var f={xId:b.x,yId:b.y,path:e};c.pathContainer[b.y][b.x]=e,c.walkableTiles.push(b),c.newFringes.push(f)})},a.prototype.canAddPath=function(a,b){if(0>b||b>this.pathContainer.length-1)return!1;var c=this.pathContainer[b];if(0>a||a>c.length-1)return!1;var d=c[a];return 0===d?!0:void 0},a.prototype.getPath=function(a,b){return this.pathContainer[b][a]},a.prototype.getWalkableTiles=function(){return this.walkableTiles},a}();a.PathFinder=b}(battle||(battle={}));var battle;!function(a){var b=function(a){function b(b,c,d,e){a.call(this,b.game,c,d,e),this.state=b,b.game.add.existing(this)}return __extends(b,a),b}(Phaser.Sprite);a.Background=b}(battle||(battle={}));var battle;!function(a){var b=function(a){function b(b,c,d,e){a.call(this,b.game,c,d,e),this.state=b,b.game.add.existing(this)}return __extends(b,a),b}(Phaser.Sprite);a.Hero=b}(battle||(battle={}));var battle;!function(a){var b=function(a){function b(b,c,d,e){a.call(this,b.game,c,d,e),this.state=b,this.anchor.setTo(.5),this.scale.y=.8,b.game.add.existing(this)}return __extends(b,a),b.prototype.changeColor=function(){this.loadTexture("hexRed",0)},b}(Phaser.Sprite);a.Tile=b}(battle||(battle={}));var battle;!function(a){var b=function(b){function c(c,d,e,f,g,h){b.call(this,c.game,0,0,d),this.state=c,this.xId=e,this.yId=f,this.speed=g,this.size=h,this.x=200+90*e,this.y=400+64*f,this.state.battleGround[f][e]=this,this.anchor.setTo(0,1),this.pathFinder=new a.PathFinder(this),c.game.add.existing(this)}return __extends(c,b),c}(Phaser.Sprite);a.Unit=b}(battle||(battle={}));var battle;!function(a){var b=function(a){function b(b,c,d,e){a.call(this,b,e,c,d,4,1),this.inputEnabled=!0,this.input.enableDrag(!0)}return __extends(b,a),b}(a.Unit);a.Wolf=b}(battle||(battle={}));var load;!function(a){var b=function(b){function c(){b.apply(this,arguments)}return __extends(c,b),c.prototype.init=function(a){this.nextState=a},c.prototype.preload=function(){new a.Logo(this,{x:this.game.width/2,y:this.game.height/2,name:"ugnis"}),this.load.image("background","images/bg2.jpg"),this.load.image("hex","images/hex.png"),this.load.image("hexRed","images/hex_red.png"),this.load.image("hexPath","images/hex_path.png"),this.load.image("unit","images/CyberHound.png")},c.prototype.create=function(){this.game.state.start(this.nextState)},c}(Phaser.State);a.State=b}(load||(load={}));var preload;!function(a){var b=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.init=function(a){this.nextState=a,this.game.scale.scaleMode=Phaser.ScaleManager.EXACT_FIT},b.prototype.preload=function(){this.load.image("ugnis","images/ugnis.jpg")},b.prototype.create=function(){this.game.state.start("loadState",!1,!1,this.nextState)},b}(Phaser.State);a.State=b}(preload||(preload={}));var load;!function(a){var b=function(a){function b(b,c){a.call(this,b.game,c.x,c.y,c.name),this.state=b,this.anchor.setTo(.5),this.alpha=0,b.game.add.existing(this),this.tween=b.game.add.tween(this),this.tweenIn(),this.text=b.game.add.text(this.x,this.y+this.height/2+20,"LOADING: 0%",{}),this.text.anchor.set(.5,.5),this.text.align="center",this.text.font="Arial Black",this.text.fontSize=50,this.text.fontWeight="bold",this.text.stroke="#000000",this.text.strokeThickness=6,this.text.fill="#ffffff",b.game.load.onFileComplete.add(this.fileComplete,this)}return __extends(b,a),b.prototype.tweenIn=function(){this.tween.to({alpha:1},1500,Phaser.Easing.Quadratic.InOut,!0,0,-1,!0)},b.prototype.fileComplete=function(a){this.text.setText("LOADING: "+a+"%")},b}(Phaser.Sprite);a.Logo=b}(load||(load={}));