"use strict";(self.webpackChunkancientbeast=self.webpackChunkancientbeast||[]).push([[99],{51099:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var i=r(21094),a=r(83355),s=r(23315),n=r(67790),h=r(71956);const c=function(e){e.abilities[4]=[{trigger:"onStartPhase",require:function(){return this.testRequirements()},activate:function(){this._addTrap(this.creature.hexagons[1]),this._addTrap(this.creature.hexagons[this.creature.player.flipped?0:2]),e.Phaser.add.audio("MagmaSpawn0").play()},_addTrap:function(t){var r=this,a=this.isUpgraded()?0:1;t.createTrap("scorched-ground",[new h.Q(this.title,this.creature,t,"onStepIn",{requireFn:function(){return!!this.trap.hex.creature&&this.trap.hex.creature.id!==r.creature.id},effectFn:function(t,a){a.takeDamage(new i.h(t.attacker,r.damages,1,[],e),{isFromTrap:!0}),this.trap.destroy(),t.deleteEffect()},attacker:this.creature},e)],this.creature.player,{turnLifetime:a,ownerCreature:this.creature,fullTurnLifetime:!0})}},{trigger:"onQuery",_lastTargetId:-1,_targetTeam:a.S.Enemy,require:function(){return!!this.testRequirements()&&!!this.atLeastOneTarget(this.creature.getHexMap(s.LY),{team:this._targetTeam})},query:function(){var t=this,r=this.creature;e.grid.queryCreature({fnOnConfirm:function(){t.animation.apply(t,arguments)},team:this._targetTeam,id:r.id,flipped:r.flipped,hexes:this.creature.getHexMap(s.LY)})},activate:function(t){var r;this.end();var a={burn:this.damages.burn,crush:this.damages.crush},s=0;for(r=0;r<t.effects.length;r++)t.effects[r].name===this.title&&t.effects[r].owner===this.creature&&s++;a.burn+=s*this.damages.burn;var n=new i.h(this.creature,a,1,[],e);t.takeDamage(n),e.Phaser.camera.shake(.02,300,!0,e.Phaser.camera.SHAKE_HORIZONTAL,!0);var c=1;for(this.isUpgraded()&&t.id===this._lastTargetId&&(c=2),this._lastTargetId=t.id,r=0;r<c;r++)t.addEffect(new h.Q(this.title,this.creature,t,"",{deleteTrigger:"",stackable:!0},e))}},{trigger:"onQuery",map:[[0,0,1,0],[0,0,1,1],[1,1,1,0],[0,0,1,1],[0,0,1,0]],require:function(){return this.testRequirements()},query:function(){var t=this,r=this.creature;this.map.origin=[0,2],e.grid.queryChoice({fnOnConfirm:function(){t.animation.apply(t,arguments)},team:a.S.Both,requireCreature:0,id:r.id,flipped:r.flipped,choices:[r.getHexMap(this.map),r.getHexMap(this.map,!0)]})},activate:function(e){var t=this;t.end();for(var r=t.getTargets(e),i=0;i<r.length;i++)if(r[i].target===this.creature){r.splice(i,1);break}t.areaDamage(t.creature,t.damages1,[],r),this.isUpgraded()&&e.forEach((function(e){e.creature&&e.creature!==t.creature||t.creature.abilities[0]._addTrap(e)}))}},{trigger:"onQuery",directions:[0,1,0,0,1,0],_targetTeam:a.S.Enemy,require:function(){if(!this.testRequirements())return!1;if(!this.creature.stats.moveable)return this.message=e.msg.abilities.notMoveable,!1;var t=this.creature,r=t.player.flipped?t.x-t.size+1:t.x;return!!this.testDirection({team:this._targetTeam,x:r,directions:this.directions})},query:function(){var t=this,r=this.creature,i=r.player.flipped?r.x-r.size+1:r.x;e.grid.queryDirection({fnOnConfirm:function(){t.animation.apply(t,arguments)},team:this._targetTeam,id:r.id,requireCreature:!0,x:i,y:r.y,directions:this.directions})},activate:function(t,r){var s=this,h=this.creature;s.end(!1,!0);for(var c=new i.h(s.creature,s.damages,1,[],e),u=0;u<this.creature.hexagons.length;u++)this.creature.hexagons[u].trap&&this.creature.hexagons[u].destroyTrap();e.Phaser.camera.shake(.01,300,!0,e.Phaser.camera.SHAKE_BOTH,!0),function t(i){var u=n.Z$(i).creature,f=h.hexagons[4===r.direction?h.size-1:0];n.B0(i,!1,!1),i.unshift(f);var o=n.Z$(i),d=o.x+(4===r.direction?h.size-1:0);o=e.grid.hexes[o.y][d],h.moveTo(o,{ignoreMovementPoint:!0,ignorePath:!0,callback:function(){i.forEach((function(e){e.trap&&e.destroyTrap()}));var f=!1;void 0!==u&&(f=u.takeDamage(c,!0).kill);var o=!1;if(s.isUpgraded()&&f){var d=e.grid.getHexLine(u.x,u.y,r.direction,!1);n.B0(d,!0,!0,h.id);var g=n.Z$(d).creature;g&&(0,a.H)(h,g,s._targetTeam)&&(o=!0,t(d))}if(!o)var p=setInterval((function(){e.freezedInput||(clearInterval(p),e.UI.selectAbility(-1),e.activeCreature.queryMove())}),100)}})}(t)}}]}},71956:(e,t,r)=>{r.d(t,{Q:()=>a});var i=r(18394);class a{constructor(e,t,r,i,a,s){this.effectFn=()=>{},this.requireFn=e=>!0,this.alterations={},this.turnLifetime=0,this.deleteTrigger="onStartOfRound",this.stackable=!0,this.specialHint=void 0,this.deleteOnOwnerDeath=!1,this._trap=void 0,this.attacker=void 0,this.id=s.effectId++,this.game=s,this.name=e,this.owner=t,this.target=r,this.trigger=i,this.creationTurn=s.turn;for(const e of Object.keys(a))e in this&&(this[e]=a[e]);s.effects.push(this)}animation(...e){e?this.activate(...e):this.activate()}activate(e){if(!this.requireFn(e))return!1;e instanceof i.j&&e.addEffect(this),this.effectFn(this,e)}deleteEffect(){if("effects"in this.target){const e=this.target.effects.indexOf(this);this.target.effects[e]?this.target.effects.splice(e,1):console.warn("Failed to find effect on target.",this)}const e=this.game.effects.indexOf(this);this.game.effects[e]?this.game.effects.splice(e,1):console.warn("Failed to find effect on game.",this),"updateAlteration"in this.target&&this.target.updateAlteration()}get trap(){return this._trap}set trap(e){this._trap=e}}}}]);