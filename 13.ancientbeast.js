(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{327:function(e,t,i){"use strict";i.r(t);var r=i(84),a=i.n(r),n=i(40),s=i.n(n),c=i(44),o=i.n(c),u=i(114),d=i(28),h=i(45),f=i(11),g=i(5),l=i(987);t.default=function(e){e.abilities[6]=[{trigger:"onCreatureSummon onOtherCreatureSummon onOtherCreatureDeath",_buff:0,require:function(){if(this.creature.dead||this.creature.temp)return!1;var t=0;return e.creatures.forEach((function(e){"S"!=e.realm||e.dead||e.temp||(t+=2)})),t!=this._buff&&(this._buff=t,!0)},activate:function(){this.creature.facePlayerDefault();var t=0;this.isUpgraded()&&(t=this._buff),this.creature.replaceEffect(new l.a("Lamellar Body",this.creature,this.creature,"",{alterations:{defense:this._buff,frost:this._buff,regrowth:t},stackable:!1},e))}},{trigger:"onQuery",_directions:[0,1,0,0,1,0],_targetTeam:d.a.enemy,_executeHealthThreshold:39,require:function(){if(!this.testRequirements())return!1;if(!this.atLeastOneTarget(this.creature.getHexMap(h.j),{team:this._targetTeam})){if(!this.isUpgraded())return!1;if(!this.testDirection({team:this._targetTeam,directions:this._directions,distance:this.creature.remainingMove+1,sourceCreature:this.creature}))return!1}return!0},query:function(){var t=this,i=this.creature,r=o()({fnOnConfirm:function(){t.animation.apply(t,arguments)},flipped:i.flipped,id:i.id,hexesDashed:i.getHexMap(h.j),team:d.a.enemy,requireCreature:!0},"flipped",i.flipped);if(r.choices=i.getHexMap(h.j).map((function(e){return[e]})),this.isUpgraded()){var a=e.grid.getDirectionChoices({flipped:i.flipped,sourceCreature:i,team:this._targetTeam,id:i.id,requireCreature:!0,x:i.x,y:i.y,distance:i.remainingMove+1,directions:this._directions});r.choices=r.choices.filter((function(e){return!a.choices.some((function(t){return e.every((function(e){return t.includes(e)}))}))})),r.choices=[].concat(s()(r.choices),s()(a.choices)),a.choices.forEach((function(t){var a=t[0].direction,n=1;(!i.flipped&&4===a||i.flipped&&1===a)&&(n=-1*i.size);var c=e.grid.getHexLine(i.x+n,i.y,t[0].direction,i.flipped);c.splice(0,t.length),c.splice(t.length-f.d(t).creature.size),r.hexesDashed=[].concat(s()(r.hexesDashed),s()(c))}))}e.grid.queryChoice(r)},activate:function(t,i){var r=this,a=r.creature;r.end();var n=f.d(t).creature;if(a.getHexMap(h.j).includes(f.d(t)))r._damageTarget(n);else{if(!this.isUpgraded())return;f.b(t,!1,!0,a.id);var s=f.d(t),c=s.x+(4===i.direction?a.size-1:0);s=e.grid.hexes[s.y][c];var o=1;(!a.flipped&&4===i.direction||a.flipped&&1===i.direction)&&(o=-1*a.size);var u=e.grid.getHexLine(a.x+o,a.y,i.direction,a.flipped);u.splice(0,t.length+n.size),u.splice(t.length),a.moveTo(s,{callback:function(){for(var t=null,i=0;i<u.length&&u[i].isWalkable(n.size,n.id,!0);i++)t=u[i];null!==t?n.moveTo(t,{callback:function(){t.creature===n&&r._damageTarget(n),e.activeCreature.queryMove()},ignoreMovementPoint:!0,ignorePath:!0,animation:"push"}):(r._damageTarget(n),e.activeCreature.queryMove())}})}},_damageTarget:function(t){var i=t.health<=this._executeHealthThreshold&&t.isFrozen(),r=i?{pure:t.health}:{crush:this.damages.crush,frost:this.damages.frost},a=new u.a(this.creature,r,1,[],e);i?(this.game.UI.chat.suppressMessage(/is dead/i,1),t.takeDamage(a).kill&&(this.game.log("%CreatureName".concat(t.id,"% has been shattered!")),t.hint("Shattered","damage"))):t.takeDamage(a)}},{trigger:"onQuery",_targetTeam:d.a.enemy,_directions:[1,1,1,1,1,1],_distance:5,require:function(){return!!this.testRequirements()&&!!this.testDirection({sourceCreature:this.creature,team:this._targetTeam,directions:this._directions,distance:this._distance,optTest:this._confirmTarget})},query:function(){var t=this,i=this.creature;e.grid.queryDirection({fnOnConfirm:function(){t.animation.apply(t,arguments)},flipped:i.player.flipped,team:this._targetTeam,id:i.id,requireCreature:!0,x:i.x,y:i.y,directions:this._directions,distance:this._distance,optTest:this._confirmTarget})},activate:function(t,i){var r=this,n=this.creature,s=f.d(t).creature;r.end();var c=e.animations.projectile(this,s,"effects_freezing-spit",t,i,52,-20),o=a()(c,2),d=o[0],h=o[1],g=Math.max(n.stats.frost-s.stats.frost,0),l=new u.a(r.creature,{frost:g},1,[],e);d.onComplete.add((function(){var t;this.destroy(),l.damages.frost>0&&(t=s.takeDamage(l)),s.freeze(r.isUpgraded()),t&&!t.kill&&(e.log("%CreatureName".concat(s.id,"% ").concat(r.isUpgraded()?"enters Cryostasis":"has been Frozen"," and cannot act")),s.hint(r.isUpgraded()?"Cryostasis":"Frozen"))}),h)},_confirmTarget:function(e){return e.isFatigued()}},{trigger:"onQuery",directions:[0,1,0,0,1,0],_targetTeam:d.a.enemy,require:function(){return!!this.testRequirements()&&!!this.testDirection({team:this._targetTeam,directions:this.directions,sourceCreature:this.creature})},query:function(){var t=this,i=this.creature;e.grid.queryDirection({fnOnSelect:function(i){var r=f.d(i).creature,a=t.creature.player.flipped?e.grid.hexes[f.d(i).y][f.d(i).x+r.size-1]:f.d(i);a.adjacentHex(t.radius).concat([a]).forEach((function(t){t.creature instanceof g.a?t.overlayVisualState("creature selected player"+t.creature.team):t.overlayVisualState("creature selected player"+e.activeCreature.team)}))},fnOnConfirm:function(){t.animation.apply(t,arguments)},flipped:i.player.flipped,team:this._targetTeam,id:this.creature.id,requireCreature:!0,x:i.x,y:i.y,sourceCreature:i})},activate:function(t){this.end();var i=f.d(t).creature,r=this.creature.player.flipped?e.grid.hexes[f.d(t).y][f.d(t).x+i.size-1]:f.d(t),a=this.getTargets(r.adjacentHex(this.radius).concat([r])),n=new l.a("Frozen",this.creature,void 0,"",{effectFn:function(e){e.target.freeze(),this.deleteEffect()}},e);this.areaDamage(this.creature,this.damages,[n],a)}}]}},987:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(3),a=i.n(r),n=i(4),s=i.n(n),c=i(0),o=i(5),u=function(){function e(t,i,r,n,s,o){a()(this,e),this.id=o.effectId++,this.game=o,this.name=t,this.owner=i,this.target=r,this.trigger=n,this.creationTurn=o.turn;var u=c.extend({requireFn:function(){return!0},effectFn:function(){},alterations:{},turnLifetime:0,deleteTrigger:"onStartOfRound",stackable:!0,noLog:!1,specialHint:void 0,deleteOnOwnerDeath:!1},s);c.extend(this,u),o.effects.push(this)}return s()(e,[{key:"animation",value:function(){this.activate.apply(this,arguments)}},{key:"activate",value:function(e){if(!this.requireFn(e))return!1;this.noLog||console.log("Effect "+this.name+" triggered"),e instanceof o.a&&e.addEffect(this),this.effectFn(this,e)}},{key:"deleteEffect",value:function(){var e=this.target.effects.indexOf(this);this.target.effects[e]?this.target.effects.splice(e,1):console.warn("Failed to find effect on target.",this);var t=this.game.effects.indexOf(this);this.game.effects[t]?this.game.effects.splice(t,1):console.warn("Failed to find effect on game.",this),this.target.updateAlteration()}}]),e}()}}]);