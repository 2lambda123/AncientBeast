"use strict";(self.webpackChunkancientbeast=self.webpackChunkancientbeast||[]).push([[302],{89302:(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var i=r(19755),a=r(21094),n=r(83355),s=r(69394),c=r(67790);const o=e=>{e.abilities[12]=[{trigger:"onCreatureMove onOtherCreatureMove",require:function(e){if(!this.testRequirements())return!1;if(this.creature===this.game.activeCreature)return!1;if(!e.creature)return!1;let t=[];if(e.creature===this.creature)t=this._detectFrontHexesWithEnemy();else if((0,n.H)(e.creature,this.creature,n.S.Enemy)){const r=this._findEnemyHexInFront(e);r&&t.push(r)}return!(!(t.length&&this.timesUsedThisTurn<this._getUsesPerTurn())||this.creature.materializationSickness||this.creature.isFrozen()||!this._getHopHex())},activate:function(){this.end(),e.Phaser.camera.shake(.01,55,!0,e.Phaser.camera.SHAKE_VERTICAL,!0),this.creature.moveTo(this._getHopHex(),{callback:function(){e.activeCreature.queryMove()},ignorePath:!0,ignoreMovementPoint:!0})},_getUsesPerTurn:function(){return this.isUpgraded()?2:1},_getHopHex:function(){const e=this._detectFrontHexesWithEnemy();let t;if(e.find((e=>1===e.direction))||e.find((e=>0===e.direction))&&e.find((e=>2===e.direction))?t=this.creature.getHexMap(s.mT,!1)[0]:e.find((e=>0===e.direction))?t=this.creature.getHexMap(s.EO,!1)[0]:e.find((e=>2===e.direction))&&(t=this.creature.getHexMap(s.xb,!1)[0]),void 0!==t&&t.isWalkable(this.creature.size,this.creature.id,!0)||(t=this.creature.getHexMap(s.mT,!1)[0]),void 0===t||t.isWalkable(this.creature.size,this.creature.id,!0))return t},_findEnemyHexInFront:function(e){return this._detectFrontHexesWithEnemy().some((({hex:t})=>e.creature===t.creature))?e:void 0},_detectFrontHexesWithEnemy:function(){return this.creature.getHexMap(s.IY,!1).reduce(((e,t,r)=>(t.creature&&(0,n.H)(t.creature,this.creature,n.S.Enemy)&&e.push({direction:r,hex:t}),e)),[])}},{trigger:"onQuery",_targetTeam:n.S.Enemy,require:function(){return!!this.testRequirements()&&!!this.atLeastOneTarget(this.creature.adjacentHexes(1),{team:this._targetTeam})},query:function(){const t=this,r=this.creature;e.grid.queryCreature({fnOnConfirm:function(){t.animation(...arguments)},team:this._targetTeam,id:r.id,flipped:r.player.flipped,hexes:r.adjacentHexes(1)})},activate:function(t){const r=this;r.end(),e.Phaser.camera.shake(.01,100,!0,e.Phaser.camera.SHAKE_HORIZONTAL,!0);const i=r.damages,n={pure:0},s=this.isUpgraded()&&t.isFrozen();if(s)for(const e in r.damages)({}).hasOwnProperty.call(r.damages,e)&&(n.pure+=r.damages[e]);const c=new a.h(r.creature,s?n:i,1,[],e);t.takeDamage(c)}},{trigger:"onQuery",directions:[1,1,1,1,1,1],_targetTeam:n.S.Both,require:function(){return!!this.testRequirements()&&!!this.testDirection({team:this._targetTeam,directions:this.directions})},query:function(){const t=this,r=this.creature;e.grid.queryDirection({fnOnConfirm:function(){t.animation(...arguments)},flipped:r.player.flipped,team:this._targetTeam,id:r.id,requireCreature:!0,x:r.x,y:r.y,directions:this.directions})},activate:function(t,r){const i=this;i.end();let a=c.Z$(t).creature;if(!a){const e=i.creature,r=t.map((e=>e.creature)).filter((t=>t&&t!=e));if(0===r.length)return;a=r[0]}const n=5-(this.isUpgraded()&&a.isFrozen()?0:a.size);let o=[];switch(r.direction){case 0:o=e.grid.getHexMap(a.x,a.y-8,0,a.flipped,s.pe).reverse();break;case 1:o=e.grid.getHexMap(a.x,a.y,0,a.flipped,s.hi);break;case 2:o=e.grid.getHexMap(a.x,a.y,0,a.flipped,s.m$);break;case 3:o=e.grid.getHexMap(a.x,a.y,-4,a.flipped,s.pe);break;case 4:o=e.grid.getHexMap(a.x,a.y,0,!a.flipped,s.hi);break;case 5:o=e.grid.getHexMap(a.x,a.y-8,-4,a.flipped,s.m$).reverse()}let u=a.hexagons[0];a.moveTo(u,{ignoreMovementPoint:!0,ignorePath:!0,callback:function(){e.activeCreature.queryMove()},animation:"push"}),e.Phaser.camera.shake(.01,400,!0,e.Phaser.camera.SHAKE_HORIZONTAL,!0),o=o.slice(0,n+1);for(let e=0;e<o.length&&o[e].isWalkable(a.size,a.id,!0);e++)u=o[e];a.moveTo(u,{ignoreMovementPoint:!0,ignorePath:!0,callback:function(){e.activeCreature.queryMove()},animation:"push"}),e.Phaser.camera.shake(.01,400,!0,e.Phaser.camera.SHAKE_HORIZONTAL,!0)}},{trigger:"onQuery",_targetTeam:n.S.Enemy,require:function(){return!!this.testRequirements()&&!!this.testDirection({team:this._targetTeam,directions:this.directions})},query:function(){const t=this,r=this.creature;e.grid.queryDirection({fnOnConfirm:function(){t.animation(...arguments)},flipped:r.player.flipped,team:this._targetTeam,id:r.id,requireCreature:!0,x:r.x,y:r.y,directions:[1,1,1,1,1,1]})},activate:function(t,r){const n=this;n.end(),e.Phaser.camera.shake(.01,90,!0,e.Phaser.camera.SHAKE_HORIZONTAL,!0);const s=t.find((e=>e.creature)).creature,c=e.animations.projectile(this,s,"effects_freezing-spit",t,r,52,-20),o=c[0],u=c[1],h=c[2];o.onComplete.add((function(){this.destroy();const t=i.extend({},n.damages);t.crush+=3*h;const r=new a.h(n.creature,t,1,[],e),c=s.takeDamage(r);n.isUpgraded()&&c.damageObj.melee&&s.freeze()}),u)}}]}}}]);