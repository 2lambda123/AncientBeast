"use strict";(self.webpackChunkancientbeast=self.webpackChunkancientbeast||[]).push([[263],{29263:(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});var i=r(21094),a=r(83355),n=r(23315),s=r(67790);const u=function(e){e.abilities[45]=[{trigger:"onReset",require:function(){return this.testRequirements()},activate:function(){this.creature.isFatigued()&&(this.isUpgraded()&&this.creature.heal(Math.floor(this.creature.stats.regrowth/2),!0),this.creature.stats.meditation>0&&this.creature.recharge(Math.floor(this.creature.stats.meditation/2)))}},{trigger:"onQuery",_targetTeam:a.S.Enemy,require:function(){return!!this.testRequirements()&&!!this.atLeastOneTarget(e.grid.getHexMap(this.creature.x-3,this.creature.y-2,0,!1,n.LY),{team:this._targetTeam})},query:function(){var t=this,r=this.creature;e.grid.queryCreature({fnOnConfirm:function(){t.animation.apply(t,arguments)},team:this._targetTeam,id:r.id,flipped:r.flipped,hexes:e.grid.getHexMap(r.x-3,r.y-2,0,!1,n.LY)})},activate:function(t){var r=this;r.end();var a=new i.h(r.creature,r.damages,1,[],e);t.takeDamage(a),this.isUpgraded()&&t.takeDamage(a)}},{trigger:"onQuery",_targetTeam:a.S.Both,require:function(){return!!this.testRequirements()&&!!this.testDirection({team:this._targetTeam,sourceCreature:this.creature})},query:function(){var t=this,r=this.creature;e.grid.queryDirection({fnOnConfirm:function(){t.animation.apply(t,arguments)},flipped:r.player.flipped,team:this._targetTeam,id:r.id,requireCreature:!0,x:r.x,y:r.y,sourceCreature:r})},activate:function(t,r){var a=this;a.end();var n=s.Z$(t).creature;if(!n){var u=a.creature,c=t.map((function(e){return e.creature})).filter((function(e){return e&&e!=u}));if(0===c.length)return;n=c[0]}for(var h=e.grid.getHexLine(n.x,n.y,r.direction,n.flipped),o=new i.h(a.creature,a.damages,1,[],e),g=n.takeDamage(o),d=0;g.kill&&!(++d>=h.length);){var f=h[d];if(f.creature){n=f.creature;var l=a.damages.sonic+(this.isUpgraded()?9:0);if(l<=0)break;o=new i.h(a.creature,{sonic:l},1,[],e),g=n.takeDamage(o)}}}},{trigger:"onQuery",_targetTeam:a.S.Both,_getDirections:function(){return this.testDirections({flipped:this.creature.player.flipped,team:this._targetTeam,id:this.creature.id,requireCreature:!0,x:this.creature.x,y:this.creature.y,distance:1,sourceCreature:this.creature,directions:[1,1,1,1,1,1],includeCreature:!0,stopOnCreature:!0})},require:function(){if(!this.testRequirements())return!1;for(var t=this._getDirections(),r=0;r<t.length;r++)if(1===t[r])return this.message="",!0;return this.message=e.msg.abilities.noTarget,!1},query:function(){var t=this,r=this.creature;e.grid.queryDirection({fnOnConfirm:function(){t.animation.apply(t,arguments)},flipped:r.player.flipped,team:this._targetTeam,id:r.id,directions:this._getDirections(),requireCreature:!0,x:r.x,y:r.y,sourceCreature:r})},activate:function(t,r){var a=this;this.end(),e.Phaser.camera.shake(.02,300,!0,e.Phaser.camera.SHAKE_HORIZONTAL,!0),function t(n,s,u){var c=new i.h(a.creature,{crush:s},1,[],e);if(!(n.takeDamage(c).kill||u<=0)){var h=e.grid.getHexLine(n.x,n.y,r.direction,!1);h=h.splice(1,u+1);for(var o=null,g=null,d=0;d<h.length&&(g=h[d],d!==h.length-1)&&h[d].isWalkable(n.size,n.id,!0);d++)o=h[d];var f=function(){if(g.creature===n&&4===r.direction){var i=e.grid.getHexLine(n.x,n.y,r.direction,!1);i=i.splice(n.size),g=i.length>0&&i[0].creature!==n?i[0]:null}if(null!==g&&g!==o&&g.creature){var c=a.isUpgraded()?s:s-5,h=a.isUpgraded()?u:u-1;t(g.creature,c,h)}else e.activeCreature.queryMove()};null!==o?n.moveTo(o,{callback:f,ignoreMovementPoint:!0,ignorePath:!0,overrideSpeed:400,animation:"push"}):f()}}(s.Z$(t).creature,this.damages.crush,3)}}]}}}]);